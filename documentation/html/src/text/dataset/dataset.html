<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>src.text.dataset.dataset API documentation</title>
<meta name="description" content="">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>src.text.dataset.dataset</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="src.text.dataset.dataset.AggregatableDataset"><code class="flex name class">
<span>class <span class="ident">AggregatableDataset</span></span>
<span>(</span><span>prompt: text.dataset.prompt.Prompt)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class AggregatableDataset(Dataset, Aggregatable, ABC):
    &#34;&#34;&#34;
    A dataset that can be aggregated.
    &#34;&#34;&#34;
    def __init__(self, prompt: Prompt):
        super().__init__()
        self.prompt = prompt

    def prefix(self) -&gt; List[str]:
        return self.prompt.prefix

    def suffix(self) -&gt; List[str]:
        return self.prompt.suffix</code></pre>
</details>
<div class="desc"><p>A dataset that can be aggregated.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="src.text.dataset.dataset.Dataset" href="#src.text.dataset.dataset.Dataset">Dataset</a></li>
<li>text.dataset.aggregatable.Aggregatable</li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="src.text.dataset.ag_news.AGNews" href="ag_news.html#src.text.dataset.ag_news.AGNews">AGNews</a></li>
<li><a title="src.text.dataset.imdb.IMBdDataset" href="imdb.html#src.text.dataset.imdb.IMBdDataset">IMBdDataset</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="src.text.dataset.dataset.AggregatableDataset.prefix"><code class="name flex">
<span>def <span class="ident">prefix</span></span>(<span>self) ‑> List[str]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def prefix(self) -&gt; List[str]:
    return self.prompt.prefix</code></pre>
</details>
<div class="desc"><p>Returns the prefix of the dataset. Can include multiple samples.
Important, is that the prefix is not too long, as it will be used in the context of the LLM.
Too long prefixes will lead to a decrease in performance, as the memory of the GPU is rather limited.
Too short prefixes will lead to a decrease in performance, as the LLM will not be able to learn from the samples.
:return: The prefix, that will be prepended to all samples during embedding.
It should be a list of strings, where each string is a word.</p></div>
</dd>
<dt id="src.text.dataset.dataset.AggregatableDataset.suffix"><code class="name flex">
<span>def <span class="ident">suffix</span></span>(<span>self) ‑> List[str]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def suffix(self) -&gt; List[str]:
    return self.prompt.suffix</code></pre>
</details>
<div class="desc"><p>Returns the suffix of the dataset. It should be short and precise.
It should guide the LLM to the correct label.
:return: The suffix, that will be appended to all samples during embedding.
It should be a list of strings, where each string is a word.</p></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="src.text.dataset.dataset.Dataset" href="#src.text.dataset.dataset.Dataset">Dataset</a></b></code>:
<ul class="hlist">
<li><code><a title="src.text.dataset.dataset.Dataset.get_testing_data" href="#src.text.dataset.dataset.Dataset.get_testing_data">get_testing_data</a></code></li>
<li><code><a title="src.text.dataset.dataset.Dataset.get_training_data" href="#src.text.dataset.dataset.Dataset.get_training_data">get_training_data</a></code></li>
<li><code><a title="src.text.dataset.dataset.Dataset.x_label_name" href="#src.text.dataset.dataset.Dataset.x_label_name">x_label_name</a></code></li>
<li><code><a title="src.text.dataset.dataset.Dataset.y_label_name" href="#src.text.dataset.dataset.Dataset.y_label_name">y_label_name</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="src.text.dataset.dataset.Dataset"><code class="flex name class">
<span>class <span class="ident">Dataset</span></span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Dataset(ABC):

    def __init__(self):
        self.imported = False
        self.x_train = self.y_train = self.x_test = self.y_test = None
        self.resources_path = Path(os.path.dirname(__file__)) / &#39;../resources&#39;
        self.dir_path = self.resources_path / self.name

    def get_training_data(self, filter_labels: list | None = None) -&gt; Tuple[Series, Series]:
        &#34;&#34;&#34;
        Returns the training data of the dataset.
        :param filter_labels: The labels to filter for. If left empty, all labels are returned.
        :return: A tuple of:
                    - The training data of the dataset.
                    - The labels of the training data.
        &#34;&#34;&#34;
        if not self.imported:
            self._import_data()
            self.imported = True
        if filter_labels is None:
            return self.x_train, self.y_train
        return self._get_filtered_data(self.x_train, self.y_train, filter_labels)

    def get_testing_data(self, filter_labels: list | None = None) -&gt; Tuple[Series, Series]:
        &#34;&#34;&#34;
        Returns the testing data of the dataset.
        :param filter_labels: The labels to filter for. If left empty, all labels are returned.
        :return: A tuple of:
                    - The testing data of the dataset.
                    - The labels of the testing data.
        &#34;&#34;&#34;
        if not self.imported:
            self._import_data()
            self.imported = True
        if filter_labels is None:
            return self.x_test, self.y_test
        return self._get_filtered_data(self.x_test, self.y_test, filter_labels)

    def _get_filtered_data(self, data: Series, labels: Series, filter_labels: list) -&gt; Tuple[Series, Series]:
        for label in filter_labels:
            if label not in self.get_possible_labels():
                raise ValueError(f&#34;Label {label} is not a possible label. Possible labels are {self.get_possible_labels()}&#34;)
        idx = labels.isin(filter_labels)
        return data[idx].reset_index(drop=True), labels[idx].reset_index(drop=True)


    def get_one_class_testing_data(self, class_label: str) -&gt; np.ndarray:
        if class_label not in self.get_possible_labels():
            raise ValueError(f&#34;Class label {class_label} is not a possible label.&#34;)
        if not self.imported:
            self._import_data()
            self.imported = True
        return self.x_test[self.y_test == class_label]

    def split(self, data):
        x = data[self.x_label_name]
        y = data[self.y_label_name]

        # Split the data into training and test sets
        self.x_train, self.x_test, self.y_train, self.y_test = train_test_split(x, y, test_size=0.2, random_state=42)
        self.imported = True

    @property
    def average_length(self):
        if not self.imported:
            self._import_data()
        return self.x_train.apply(lambda x: len(x)).mean()

    @abstractmethod
    def get_possible_labels(self) -&gt; list:
        pass

    @abstractmethod
    def _import_data(self):
        pass

    @property
    @abstractmethod
    def name(self) -&gt; str:
        pass

    @property
    @abstractmethod
    def x_label_name(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the name of the x-axis label.
        :return: A string representing the x-axis label.
        &#34;&#34;&#34;
        pass

    @property
    @abstractmethod
    def y_label_name(self):
        &#34;&#34;&#34;
        Returns the name of the y-axis label.
        :return: A string representing the y-axis label.
        &#34;&#34;&#34;
        pass</code></pre>
</details>
<div class="desc"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="src.text.dataset.dataset.AggregatableDataset" href="#src.text.dataset.dataset.AggregatableDataset">AggregatableDataset</a></li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="src.text.dataset.dataset.Dataset.average_length"><code class="name">prop <span class="ident">average_length</span></code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def average_length(self):
    if not self.imported:
        self._import_data()
    return self.x_train.apply(lambda x: len(x)).mean()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="src.text.dataset.dataset.Dataset.name"><code class="name">prop <span class="ident">name</span> : str</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
@abstractmethod
def name(self) -&gt; str:
    pass</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="src.text.dataset.dataset.Dataset.x_label_name"><code class="name">prop <span class="ident">x_label_name</span> : str</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
@abstractmethod
def x_label_name(self) -&gt; str:
    &#34;&#34;&#34;
    Returns the name of the x-axis label.
    :return: A string representing the x-axis label.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
<div class="desc"><p>Returns the name of the x-axis label.
:return: A string representing the x-axis label.</p></div>
</dd>
<dt id="src.text.dataset.dataset.Dataset.y_label_name"><code class="name">prop <span class="ident">y_label_name</span></code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
@abstractmethod
def y_label_name(self):
    &#34;&#34;&#34;
    Returns the name of the y-axis label.
    :return: A string representing the y-axis label.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
<div class="desc"><p>Returns the name of the y-axis label.
:return: A string representing the y-axis label.</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="src.text.dataset.dataset.Dataset.get_one_class_testing_data"><code class="name flex">
<span>def <span class="ident">get_one_class_testing_data</span></span>(<span>self, class_label: str) ‑> numpy.ndarray</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_one_class_testing_data(self, class_label: str) -&gt; np.ndarray:
    if class_label not in self.get_possible_labels():
        raise ValueError(f&#34;Class label {class_label} is not a possible label.&#34;)
    if not self.imported:
        self._import_data()
        self.imported = True
    return self.x_test[self.y_test == class_label]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="src.text.dataset.dataset.Dataset.get_possible_labels"><code class="name flex">
<span>def <span class="ident">get_possible_labels</span></span>(<span>self) ‑> list</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@abstractmethod
def get_possible_labels(self) -&gt; list:
    pass</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="src.text.dataset.dataset.Dataset.get_testing_data"><code class="name flex">
<span>def <span class="ident">get_testing_data</span></span>(<span>self, filter_labels: list | None = None) ‑> Tuple[pandas.core.series.Series, pandas.core.series.Series]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_testing_data(self, filter_labels: list | None = None) -&gt; Tuple[Series, Series]:
    &#34;&#34;&#34;
    Returns the testing data of the dataset.
    :param filter_labels: The labels to filter for. If left empty, all labels are returned.
    :return: A tuple of:
                - The testing data of the dataset.
                - The labels of the testing data.
    &#34;&#34;&#34;
    if not self.imported:
        self._import_data()
        self.imported = True
    if filter_labels is None:
        return self.x_test, self.y_test
    return self._get_filtered_data(self.x_test, self.y_test, filter_labels)</code></pre>
</details>
<div class="desc"><p>Returns the testing data of the dataset.
:param filter_labels: The labels to filter for. If left empty, all labels are returned.
:return: A tuple of:
- The testing data of the dataset.
- The labels of the testing data.</p></div>
</dd>
<dt id="src.text.dataset.dataset.Dataset.get_training_data"><code class="name flex">
<span>def <span class="ident">get_training_data</span></span>(<span>self, filter_labels: list | None = None) ‑> Tuple[pandas.core.series.Series, pandas.core.series.Series]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_training_data(self, filter_labels: list | None = None) -&gt; Tuple[Series, Series]:
    &#34;&#34;&#34;
    Returns the training data of the dataset.
    :param filter_labels: The labels to filter for. If left empty, all labels are returned.
    :return: A tuple of:
                - The training data of the dataset.
                - The labels of the training data.
    &#34;&#34;&#34;
    if not self.imported:
        self._import_data()
        self.imported = True
    if filter_labels is None:
        return self.x_train, self.y_train
    return self._get_filtered_data(self.x_train, self.y_train, filter_labels)</code></pre>
</details>
<div class="desc"><p>Returns the training data of the dataset.
:param filter_labels: The labels to filter for. If left empty, all labels are returned.
:return: A tuple of:
- The training data of the dataset.
- The labels of the training data.</p></div>
</dd>
<dt id="src.text.dataset.dataset.Dataset.split"><code class="name flex">
<span>def <span class="ident">split</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def split(self, data):
    x = data[self.x_label_name]
    y = data[self.y_label_name]

    # Split the data into training and test sets
    self.x_train, self.x_test, self.y_train, self.y_test = train_test_split(x, y, test_size=0.2, random_state=42)
    self.imported = True</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="src.text.dataset" href="index.html">src.text.dataset</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="src.text.dataset.dataset.AggregatableDataset" href="#src.text.dataset.dataset.AggregatableDataset">AggregatableDataset</a></code></h4>
<ul class="">
<li><code><a title="src.text.dataset.dataset.AggregatableDataset.prefix" href="#src.text.dataset.dataset.AggregatableDataset.prefix">prefix</a></code></li>
<li><code><a title="src.text.dataset.dataset.AggregatableDataset.suffix" href="#src.text.dataset.dataset.AggregatableDataset.suffix">suffix</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="src.text.dataset.dataset.Dataset" href="#src.text.dataset.dataset.Dataset">Dataset</a></code></h4>
<ul class="">
<li><code><a title="src.text.dataset.dataset.Dataset.average_length" href="#src.text.dataset.dataset.Dataset.average_length">average_length</a></code></li>
<li><code><a title="src.text.dataset.dataset.Dataset.get_one_class_testing_data" href="#src.text.dataset.dataset.Dataset.get_one_class_testing_data">get_one_class_testing_data</a></code></li>
<li><code><a title="src.text.dataset.dataset.Dataset.get_possible_labels" href="#src.text.dataset.dataset.Dataset.get_possible_labels">get_possible_labels</a></code></li>
<li><code><a title="src.text.dataset.dataset.Dataset.get_testing_data" href="#src.text.dataset.dataset.Dataset.get_testing_data">get_testing_data</a></code></li>
<li><code><a title="src.text.dataset.dataset.Dataset.get_training_data" href="#src.text.dataset.dataset.Dataset.get_training_data">get_training_data</a></code></li>
<li><code><a title="src.text.dataset.dataset.Dataset.name" href="#src.text.dataset.dataset.Dataset.name">name</a></code></li>
<li><code><a title="src.text.dataset.dataset.Dataset.split" href="#src.text.dataset.dataset.Dataset.split">split</a></code></li>
<li><code><a title="src.text.dataset.dataset.Dataset.x_label_name" href="#src.text.dataset.dataset.Dataset.x_label_name">x_label_name</a></code></li>
<li><code><a title="src.text.dataset.dataset.Dataset.y_label_name" href="#src.text.dataset.dataset.Dataset.y_label_name">y_label_name</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
